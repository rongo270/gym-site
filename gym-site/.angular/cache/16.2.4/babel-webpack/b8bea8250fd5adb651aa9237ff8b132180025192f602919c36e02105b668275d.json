{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { ProductsService } from 'src/Service/products/products.service';\nexport let ProductUserComponent = class ProductUserComponent {\n  constructor(productsService, router, cartService, userService) {\n    this.productsService = productsService;\n    this.router = router;\n    this.cartService = cartService;\n    this.userService = userService;\n    this.products = [];\n    this.cartItems = [];\n    //struct in the start\n    this.addCartRequest = {\n      CartId: '',\n      userId: '',\n      ProductId: '',\n      Quantity: 1\n    };\n  }\n  ngOnInit() {\n    this.productsService.getAllProducts().subscribe({\n      next: products => {\n        console.log(products);\n        this.products = products;\n        this.loadProductImages();\n      },\n      error: respose => console.log(respose)\n    });\n    this.cartService.getCartItems().subscribe(items => {\n      this.cartItems = items;\n    });\n  }\n  loadProductImages() {\n    console.log(\"loadproduct\");\n    this.products.forEach(product => {\n      //console.log(product.id);\n      this.productsService.GetImage(product.id).subscribe({\n        next: ImageData => product.image = URL.createObjectURL(ImageData),\n        error: error => console.error(error)\n      });\n      //console.log(product.image);\n    });\n  }\n\n  addToCart(item) {\n    if (!this.userService.LogStatus) {\n      this.cartService.addToCart(item);\n      item.available = item.available - 1;\n      this.productsService.updateProduct(item.id, item).subscribe({\n        next: product => {\n          this.router.navigate(['products']); //routet back to products page\n        },\n\n        error: respose => {\n          console.log(respose);\n        }\n      });\n    } else {\n      this.addCartItem(item);\n    }\n  }\n  addCartItem(item) {\n    this.addCartRequest.CartId = '00000000-0000-0000-0000-000000000000'; //needs a diffult id\n    this.addCartRequest.ProductId = item.id;\n    this.addCartRequest.userId = this.userService.getIdfromToken();\n    this.cartService.addToCartUser(this.addCartRequest).subscribe({\n      next: response => {\n        console.log(\"Item added to cart successfully\");\n      },\n      error: error => {\n        console.log(\"Problem adding to cart: \", error);\n      }\n    });\n  }\n};\nProductUserComponent = __decorate([Component({\n  selector: 'app-product-user',\n  templateUrl: './product-user.component.html',\n  styleUrls: ['./product-user.component.scss'],\n  providers: [ProductsService]\n})], ProductUserComponent);","map":{"version":3,"names":["Component","ProductsService","ProductUserComponent","constructor","productsService","router","cartService","userService","products","cartItems","addCartRequest","CartId","userId","ProductId","Quantity","ngOnInit","getAllProducts","subscribe","next","console","log","loadProductImages","error","respose","getCartItems","items","forEach","product","GetImage","id","ImageData","image","URL","createObjectURL","addToCart","item","LogStatus","available","updateProduct","navigate","addCartItem","getIdfromToken","addToCartUser","response","__decorate","selector","templateUrl","styleUrls","providers"],"sources":["C:\\angular\\gym-site\\src\\pages\\products\\product-user\\product-user.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ProductsService } from 'src/Service/products/products.service'\nimport { product } from 'src/models/product.model'\nimport { Router, ActivatedRoute } from '@angular/router'\nimport { CartService } from '../../../Service/cart/cart.service';\r\nimport { UsersService } from '../../../Service/Users/users.service';\r\nimport { CartItem } from '../../../models/CartItem.model';\r\n\n@Component({\n  selector: 'app-product-user',\n  templateUrl: './product-user.component.html',\n  styleUrls: ['./product-user.component.scss'],\n  providers: [ProductsService]\n})\nexport class ProductUserComponent {\n  products: product[] = [];\n  cartItems: product[] = [];\n\n  constructor(private productsService: ProductsService,\n    private router: Router,\n    private cartService: CartService,\n    private userService: UsersService\n  ) { }\n\n  //struct in the start\n  addCartRequest: CartItem = {\n    CartId: '',\r\n    userId: '',\r\n    ProductId: '',\r\n    Quantity: 1\r\n  }\n\n  ngOnInit() {\n    this.productsService.getAllProducts().subscribe({//get all product int array in put it in products\n      next: (products) => {\n        console.log(products);\n        this.products = products;\n        this.loadProductImages();\n      },\n      error: (respose) =>\n        console.log(respose),\n    });\n    this.cartService.getCartItems().subscribe((items) => {\r\n      this.cartItems = items;\r\n    });\n  }\n\n\n  private loadProductImages(): void {\n    console.log(\"loadproduct\")\n    this.products.forEach((product) => {\n      //console.log(product.id);\n      this.productsService.GetImage(product.id).subscribe({\n        next: (ImageData) => (product.image = URL.createObjectURL(ImageData)),\n        error: (error) => console.error(error),\n      })\n      //console.log(product.image);\n    })\n  }\n  addToCart(item: product): void {\r\n    if (!this.userService.LogStatus) {\r\n      this.cartService.addToCart(item);\r\n      item.available = item.available - 1;\r\n      this.productsService.updateProduct(item.id, item).subscribe({\r\n        next: (product) => {\r\n          this.router.navigate(['products']);//routet back to products page\r\n        },\r\n        error: (respose) => {\n          console.log(respose);\n        }\r\n      })\r\n    }\r\n    else {\r\n      this.addCartItem(item);\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  addCartItem(item: product) {//add product\r\n    this.addCartRequest.CartId = '00000000-0000-0000-0000-000000000000';//needs a diffult id\r\n    this.addCartRequest.ProductId = item.id;\r\n    this.addCartRequest.userId = <any>this.userService.getIdfromToken();\r\n    this.cartService.addToCartUser(this.addCartRequest).subscribe({\r\n      next: (response) => {//after go to product page\r\n        console.log(\"Item added to cart successfully\");\r\n      },\r\n      error: (error) => {\n        console.log(\"Problem adding to cart: \", error);\n      }\r\n    });\r\n  }\r\n\r\n\r\n}\n"],"mappings":";AAAA,SAASA,SAAS,QAAgB,eAAe;AACjD,SAASC,eAAe,QAAQ,uCAAuC;AAahE,WAAMC,oBAAoB,GAA1B,MAAMA,oBAAoB;EAI/BC,YAAoBC,eAAgC,EAC1CC,MAAc,EACdC,WAAwB,EACxBC,WAAyB;IAHf,KAAAH,eAAe,GAAfA,eAAe;IACzB,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,WAAW,GAAXA,WAAW;IACX,KAAAC,WAAW,GAAXA,WAAW;IANrB,KAAAC,QAAQ,GAAc,EAAE;IACxB,KAAAC,SAAS,GAAc,EAAE;IAQzB;IACA,KAAAC,cAAc,GAAa;MACzBC,MAAM,EAAE,EAAE;MACVC,MAAM,EAAE,EAAE;MACVC,SAAS,EAAE,EAAE;MACbC,QAAQ,EAAE;KACX;EARG;EAUJC,QAAQA,CAAA;IACN,IAAI,CAACX,eAAe,CAACY,cAAc,EAAE,CAACC,SAAS,CAAC;MAC9CC,IAAI,EAAGV,QAAQ,IAAI;QACjBW,OAAO,CAACC,GAAG,CAACZ,QAAQ,CAAC;QACrB,IAAI,CAACA,QAAQ,GAAGA,QAAQ;QACxB,IAAI,CAACa,iBAAiB,EAAE;MAC1B,CAAC;MACDC,KAAK,EAAGC,OAAO,IACbJ,OAAO,CAACC,GAAG,CAACG,OAAO;KACtB,CAAC;IACF,IAAI,CAACjB,WAAW,CAACkB,YAAY,EAAE,CAACP,SAAS,CAAEQ,KAAK,IAAI;MAClD,IAAI,CAAChB,SAAS,GAAGgB,KAAK;IACxB,CAAC,CAAC;EACJ;EAGQJ,iBAAiBA,CAAA;IACvBF,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1B,IAAI,CAACZ,QAAQ,CAACkB,OAAO,CAAEC,OAAO,IAAI;MAChC;MACA,IAAI,CAACvB,eAAe,CAACwB,QAAQ,CAACD,OAAO,CAACE,EAAE,CAAC,CAACZ,SAAS,CAAC;QAClDC,IAAI,EAAGY,SAAS,IAAMH,OAAO,CAACI,KAAK,GAAGC,GAAG,CAACC,eAAe,CAACH,SAAS,CAAE;QACrER,KAAK,EAAGA,KAAK,IAAKH,OAAO,CAACG,KAAK,CAACA,KAAK;OACtC,CAAC;MACF;IACF,CAAC,CAAC;EACJ;;EACAY,SAASA,CAACC,IAAa;IACrB,IAAI,CAAC,IAAI,CAAC5B,WAAW,CAAC6B,SAAS,EAAE;MAC/B,IAAI,CAAC9B,WAAW,CAAC4B,SAAS,CAACC,IAAI,CAAC;MAChCA,IAAI,CAACE,SAAS,GAAGF,IAAI,CAACE,SAAS,GAAG,CAAC;MACnC,IAAI,CAACjC,eAAe,CAACkC,aAAa,CAACH,IAAI,CAACN,EAAE,EAAEM,IAAI,CAAC,CAAClB,SAAS,CAAC;QAC1DC,IAAI,EAAGS,OAAO,IAAI;UAChB,IAAI,CAACtB,MAAM,CAACkC,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;QACrC,CAAC;;QACDjB,KAAK,EAAGC,OAAO,IAAI;UACjBJ,OAAO,CAACC,GAAG,CAACG,OAAO,CAAC;QACtB;OACD,CAAC;KACH,MACI;MACH,IAAI,CAACiB,WAAW,CAACL,IAAI,CAAC;;EAE1B;EAKAK,WAAWA,CAACL,IAAa;IACvB,IAAI,CAACzB,cAAc,CAACC,MAAM,GAAG,sCAAsC,CAAC;IACpE,IAAI,CAACD,cAAc,CAACG,SAAS,GAAGsB,IAAI,CAACN,EAAE;IACvC,IAAI,CAACnB,cAAc,CAACE,MAAM,GAAQ,IAAI,CAACL,WAAW,CAACkC,cAAc,EAAE;IACnE,IAAI,CAACnC,WAAW,CAACoC,aAAa,CAAC,IAAI,CAAChC,cAAc,CAAC,CAACO,SAAS,CAAC;MAC5DC,IAAI,EAAGyB,QAAQ,IAAI;QACjBxB,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;MAChD,CAAC;MACDE,KAAK,EAAGA,KAAK,IAAI;QACfH,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEE,KAAK,CAAC;MAChD;KACD,CAAC;EACJ;CAGD;AAjFYpB,oBAAoB,GAAA0C,UAAA,EANhC5C,SAAS,CAAC;EACT6C,QAAQ,EAAE,kBAAkB;EAC5BC,WAAW,EAAE,+BAA+B;EAC5CC,SAAS,EAAE,CAAC,+BAA+B,CAAC;EAC5CC,SAAS,EAAE,CAAC/C,eAAe;CAC5B,CAAC,C,EACWC,oBAAoB,CAiFhC"},"metadata":{},"sourceType":"module","externalDependencies":[]}